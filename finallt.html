<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±æ–‡å­—æ ¹åˆ†è§£å™¨ - CSV å¯¦æ™‚è®€å–ç‰ˆ</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <style>
        :root {
            --bg-color: #0E1117;
            --sidebar-color: #161B22;
            --border-color: #30363D;
            --success-bg: #163020;
            --success-text: #4ADE80;
            --info-blue: #0C1D33;
            --accent-blue: #58A6FF;
            --text-main: #FFFFFF;
            --text-dim: #8B949E;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            display: flex;
            min-height: 100vh;
        }

        aside {
            width: 280px;
            background-color: var(--sidebar-color);
            border-right: 1px solid var(--border-color);
            padding: 25px;
            box-sizing: border-box;
            position: fixed;
            height: 100vh;
        }

        main {
            flex: 1;
            margin-left: 280px;
            padding: 40px;
            max-width: 900px;
        }

        .search-box {
            width: 100%;
            padding: 14px;
            background: #0d1117;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: white;
            font-size: 1.1rem;
            margin-bottom: 30px;
            outline: none;
        }

        .status-success {
            background-color: var(--success-bg);
            border-radius: 6px;
            padding: 12px 15px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            font-weight: 500;
        }

        .root-tag-box {
            background-color: var(--success-bg);
            padding: 12px 15px;
            border-radius: 6px;
            color: var(--success-text);
            font-family: monospace;
            margin-bottom: 10px;
            border: 1px solid rgba(74, 222, 128, 0.2);
        }

        .loading-overlay {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #f1c40f;
            color: black;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            z-index: 100;
        }
    </style>
</head>

<body>

    <div id="app" style="display: contents;">
        <div v-if="isLoading" class="loading-overlay">â³ æ­£åœ¨è¼‰å…¥ CSV å­—åº«...</div>

        <aside>
            <h3>âš™ï¸ è¨­å®šé¢æ¿</h3>
            <label style="font-size: 0.8rem; color: var(--text-dim);">Google API Key</label>
            <input type="password" v-model="apiKey" placeholder="åœ¨æ­¤è¼¸å…¥ Key..."
                style="width: 100%; background: #0d1117; border: 1px solid var(--border-color); color: white; padding: 10px; border-radius: 4px; box-sizing: border-box;">
            <hr style="border:0; border-top:1px solid var(--border-color); margin: 20px 0;">
            <div style="color: var(--text-dim); font-size: 0.85rem; line-height: 1.6;">
                <b>è³‡æ–™ç‹€æ…‹ï¼š</b><br>
                CSV æª”æ¡ˆï¼š{{ csvStatus }}<br>
                ç¸½å­—æ•¸ï¼š{{ Object.keys(vocabData).length }}
            </div>
        </aside>

        <main>
            <h1>ğŸ“‘ è‹±æ–‡å­—æ ¹åˆ†è§£å™¨</h1>
            <input type="text" class="search-box" v-model="query" placeholder="ğŸ” è«‹è¼¸å…¥è¦åˆ†è§£çš„è‹±æ–‡å–®å­—...">

            <div v-if="query.trim()" style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
                <section>
                    <h3>ğŸ“‘ è©å½™æŸ¥è©¢çµæœ</h3>
                    <div v-if="currentWordData">
                        <div class="status-success">âœ… è©å½™ä¸­æœ‰è©²å–®å­—</div>
                        <div v-for="(val, key) in currentWordData" :key="key" style="margin-bottom: 10px;">
                            <b style="color:var(--text-dim)">{{ key }}ï¼š</b> {{ val }}
                        </div>
                    </div>
                    <div v-else style="color: #E2B714;">
                        âš ï¸ å­—åº«ä¸­æŸ¥ç„¡æ­¤å–®å­—ã€‚
                    </div>
                </section>

                <section>
                    <h3>ğŸ¤– æœ¬åœ°å­—æ ¹è§£æ</h3>
                    <div v-for="root in detectedRoots" :key="root.key" class="root-tag-box">
                        <b>{{ root.key }}</b> â†’ {{ root.val }}
                    </div>
                </section>
            </div>
        </main>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    query: '',
                    apiKey: '',
                    isLoading: true,
                    csvStatus: 'ç­‰å¾…ä¸­...',
                    vocabData: {}, // é€™è£¡æœƒå­˜æ”¾è§£æå¾Œçš„ CSV è³‡æ–™
                    wordRoots: {
                        'anti': 'åå°ã€å°æŠ— (against)', 'auto': 'è‡ªæˆ‘ (self)', 'bi': 'äºŒ (two)',
                        'co': 'å…±åŒ (together)', 'de': 'å‘ä¸‹ã€å»é™¤ (down/remove)', 'dis': 'ä¸ã€ç›¸å (not/opposite)',
                        'ex': 'å‘å¤–ã€å‰ä»» (out/former)', 'inter': 'ä¹‹é–“ (between)', 'mis': 'éŒ¯èª¤ (wrong)',
                        'non': 'éã€ä¸ (not)', 'pre': 'é å…ˆ (before)', 're': 'å†æ¬¡ã€å¾€å› (again/back)',
                        'sub': 'åœ¨ä¸‹é¢ (under)', 'super': 'åœ¨ä¸Šé¢ã€è¶…è¶Š (above/over)', 'trans': 'ç©¿è¶Š (across)',
                        'un': 'ä¸ã€å¦å®š (not)', 'tri': 'ä¸‰ (three)', 'uni': 'ä¸€ (one)',
                        'ann': 'å¹´ (year)', 'audi': 'è½ (listen)', 'bio': 'ç”Ÿå‘½ (life)',
                        'cept': 'æ‹¿ã€å– (take/seize)', 'cede': 'è¡Œé€²ã€è®“æ­¥ (go/yield)', 'circ': 'ç’°ã€åœ“ (circle)',
                        'dict': 'èªª (say/speak)', 'duc': 'å¼•å° (lead)', 'form': 'å½¢ç‹€ (shape)',
                        'graph': 'å¯«ã€ç•« (write/draw)', 'ject': 'æŠ•ã€æ“² (throw)', 'manu': 'æ‰‹ (hand)',
                        'mob': 'ç§»å‹• (move)', 'port': 'æ¬é‹ (carry)', 'pos': 'æ”¾ç½® (put/place)',
                        'rupt': 'ç ´è£‚ (break)', 'scribe': 'å¯« (write)', 'spec': 'çœ‹ (look/see)',
                        'struct': 'å»ºç«‹ (build)', 'vid': 'çœ‹ (see)', 'viv': 'æ´» (live)',
                        'voc': 'è²éŸ³ (voice)', 'path': 'æ„Ÿæƒ… (feel/suffer)', 'phil': 'æ„› (love)',
                        'able': 'èƒ½å¤ ...çš„ (can be done)', 'al': 'é—œæ–¼...çš„ (pertaining to)', 'er': 'äººã€ç‰© (person/thing)',
                        'ful': 'å……æ»¿...çš„ (full of)', 'ion': 'è¡Œç‚ºã€éç¨‹ (act/process)', 'ism': 'ä¸»ç¾©ã€ä¿¡å¿µ (belief/ism)',
                        'ist': 'å°ˆå®¶ã€äºº (specialist)', 'ity': 'ç‹€æ…‹ã€æ€§è³ª (state/quality)', 'less': 'æ²’æœ‰ (without)',
                        'ly': 'åœ°ã€ç‹€æ…‹ (how something is)', 'ment': 'è¡Œç‚ºã€çµæœ (action/result)', 'ness': 'æ€§è³ªã€ç‹€æ…‹ (state/quality)'
                    }
                }
            },
            computed: {
                currentWordData() {
                    const q = this.query.toLowerCase().trim();
                    return this.vocabData[q] || null;
                },
                detectedRoots() {
                    const word = this.query.toLowerCase().trim();
                    if (!word) return [];
                    return Object.entries(this.wordRoots)
                        .filter(([key]) => word.includes(key))
                        .map(([key, val]) => ({ key, val }))
                        .sort((a, b) => b.key.length - a.key.length);
                }
            },
            mounted() {
                this.loadCSV();
            },
            // ... (å…¶é¤˜ HTML/CSS ä¿æŒä¸è®Š)

            methods: {
                loadCSV() {
                    // ä½¿ç”¨ GitHub Pages ç›¸å®¹çš„ç›¸å°è·¯å¾‘
                    const csvPath = "å¤§è€ƒä¸­å¿ƒåˆ†ç´šå­—å½™.csv";

                    Papa.parse(csvPath, {
                        download: true,
                        header: true,
                        skipEmptyLines: true,
                        encoding: "UTF-8", // å»ºè­° CSV å„²å­˜ç‚º UTF-8
                        complete: (results) => {
                            const dict = {};
                            if (results.data.length === 0) {
                                this.csvStatus = 'è®€å–æˆåŠŸä½†ç„¡è³‡æ–™';
                                return;
                            }

                            results.data.forEach(row => {
                                // è‡ªå‹•æ¸…ç†éµå€¼å°çš„ç©ºç™½å­—å…ƒ
                                const cleanedRow = {};
                                Object.keys(row).forEach(k => cleanedRow[k.trim()] = row[k]);

                                const wordKey = cleanedRow.word || cleanedRow.Word || cleanedRow['å–®å­—'];
                                if (wordKey) {
                                    dict[wordKey.toLowerCase().trim()] = cleanedRow;
                                }
                            });

                            this.vocabData = dict;
                            this.isLoading = false;
                            this.csvStatus = 'âœ… å·²é€£ç·šä¸¦è¼‰å…¥';
                        },
                        error: (err) => {
                            console.error("CSV Error:", err);
                            this.csvStatus = 'âŒ æ‰¾ä¸åˆ° CSV æª”æ¡ˆ';
                            this.isLoading = false;
                        }
                    });
                }
            }

        }).mount('#app')
    </script>

</body>

</html>